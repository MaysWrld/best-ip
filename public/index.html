<script>
    // 域名列表和 DNS URL 注入点：将被 functions/[[path]].js 替换
    /* TARGET_DOMAINS_PLACEHOLDER */

    // --- 工具函数 ---
    
    // ... (保留 showToast, clearOutput, manualCopy 函数不变) ...

    // 单个域名 DNS 解析 (使用 DNS_URL_TEMPLATE)
    async function resolveOne(domain, type) {
      try {
        // 使用注入的 DNS_URL_TEMPLATE 变量
        let url = DNS_URL_TEMPLATE.replace('NAME', encodeURIComponent(domain));
        url = url.replace('TYPE', type);

        const res = await fetch(url);
        if (!res.ok) return [];
        const data = await res.json();
        
        // 注意：不同的 DNS 服务商返回的 JSON 结构可能略有不同。
        // 我们假设返回的是一个包含 Answer 数组的标准 DoH JSON 结构。
        return (data.Answer || []).map(a => a.data).filter(Boolean);
        
      } catch (e) {
        console.warn(`解析 ${domain} (${type}) 失败`);
        return [];
      }
    }

    // 综合解析 A 和 AAAA 记录 (保持不变)
    async function resolveDomain(domain) {
        // ... (保持不变) ...
    }

    // ... (保持 getIPs 函数不变) ...
</script>
